<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Amazonia Concrete</title>
    <link rel="stylesheet" href="admin.css">
</head>
<body>
    <div id="notificationContainer" class="notification-container" aria-live="polite"></div>
    <div class="admin-header">
        <h1>üõ†Ô∏è Panel de Administraci√≥n - Amazonia Concrete</h1>
        <p>Gestiona tu cat√°logo de productos de forma f√°cil y r√°pida</p>
    </div>

    <div class="admin-container">
        <div class="info-box">
            <strong>üí° Instrucciones:</strong> Configura tu informaci√≥n de contacto, a√±ade o edita productos, y luego genera tu cat√°logo actualizado con el bot√≥n "Generar Cat√°logo".
        </div>

        <div class="admin-grid">
            <!-- Sidebar -->
            <div class="sidebar">
                <h3 class="section-title">Men√∫</h3>
                <button class="btn btn-primary btn-block" data-section="config" aria-controls="configSection" aria-expanded="true">‚öôÔ∏è Configuraci√≥n</button>
                <button class="btn btn-primary btn-block" data-section="products" aria-controls="productsSection" aria-expanded="false">üì¶ Productos</button>
                <button class="btn btn-success btn-block mt-md" data-action="generate-catalog">üì• Generar Cat√°logo</button>
                <button class="btn btn-secondary btn-block" id="updatePreviewButton">üîÑ Actualizar vista previa</button>

                <div id="navigationStatus" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>

                <div class="sidebar-section">
                    <h4 class="sidebar-section-title">Acciones R√°pidas</h4>
                    <button class="btn btn-secondary btn-block" id="saveDataButton">üíæ Guardar Cambios</button>
                    <button class="btn btn-secondary btn-block" id="loadDataButton">üìÇ Cargar Datos</button>
                    <button class="btn btn-secondary btn-block" id="exportDataButton">üì§ Exportar Datos</button>
                    <button class="btn btn-secondary btn-block" id="importDataButton">üì• Importar Datos</button>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Configuration Section -->
                <div id="configSection" class="section" role="region" aria-labelledby="configSectionTitle" aria-hidden="false">
                    <h2 class="section-title" id="configSectionTitle">‚öôÔ∏è Configuraci√≥n General</h2>
                    
                    <div class="config-section">
                        <h3 style="margin-bottom: 1rem">Informaci√≥n de Contacto</h3>
                        <div class="two-columns">
                            <div class="form-group">
                                <label>N√∫mero de WhatsApp (con c√≥digo de pa√≠s):</label>
                                <input type="text" id="whatsapp" placeholder="573001234567" value="573000000000">
                            </div>
                            <div class="form-group">
                                <label>Email de contacto:</label>
                                <input type="email" id="email" placeholder="info@amazoniaconcrete.com" value="info@amazoniaconcrete.com">
                            </div>
                            <div class="form-group">
                                <label>Tel√©fono de contacto:</label>
                                <input type="text" id="phone" placeholder="+57 300 123 4567" value="+57 300 000 0000">
                            </div>
                            <div class="form-group">
                                <label>Direcci√≥n (opcional):</label>
                                <input type="text" id="address" placeholder="Calle 123 #45-67, Ciudad">
                            </div>
                        </div>
                    </div>

                    <div class="config-section">
                        <h3 style="margin-bottom: 1rem">Redes Sociales</h3>
                        <div class="two-columns">
                            <div class="form-group">
                                <label>Instagram:</label>
                                <input type="url" id="instagram" placeholder="https://www.instagram.com/amazoniaconcrete">
                            </div>
                            <div class="form-group">
                                <label>Facebook:</label>
                                <input type="url" id="facebook" placeholder="https://www.facebook.com/amazoniaconcrete">
                            </div>
                            <div class="form-group">
                                <label>TikTok:</label>
                                <input type="url" id="tiktok" placeholder="https://www.tiktok.com/@amazoniaconcrete">
                            </div>
                        </div>
                        <small style="display: block; margin-top: 0.5rem; color: #555;">Ingresa enlaces completos que comiencen con <code>https://</code>.</small>
                    </div>

                    <div class="config-section">
                        <h3 style="margin-bottom: 1rem">Informaci√≥n de la Empresa</h3>
                        <div class="form-group">
                            <label>Nombre de la empresa:</label>
                            <input type="text" id="companyName" value="AMAZONIA CONCRETE">
                        </div>
                        <div class="form-group">
                            <label>Eslogan:</label>
                            <input type="text" id="tagline" value="Naturaleza y Modernidad en Perfecta Armon√≠a">
                        </div>
                        <div class="form-group">
                            <label>Logo de la empresa:</label>
                            <input type="url" id="companyLogoUrl" placeholder="https://raw.githubusercontent.com/...">
                            <small style="display: block; margin-top: 0.5rem; color: #555;">Usa un enlace directo de <code>raw.githubusercontent.com</code> u otro hosting p√∫blico.</small>
                            <div class="logo-preview" id="companyLogoPreviewWrapper">
                                <img id="companyLogoPreview" alt="Vista previa del logo" src="">
                                <span class="image-placeholder" id="companyLogoPlaceholder">Sin logo seleccionado</span>
                            </div>
                            <button type="button" class="btn btn-secondary" id="removeLogoButton">Quitar logo</button>
                        </div>
                        <div class="form-group">
                            <label>Mensaje del footer:</label>
                            <textarea id="footerMessage">Creando espacios √∫nicos con concreto sostenible</textarea>
                        </div>
                    </div>

                    <!-- Apariencia del cat√°logo: mantener esta secci√≥n inmediatamente despu√©s de la informaci√≥n de la empresa -->
                    <div class="config-section">
                        <h3 style="margin-bottom: 1rem">Apariencia del cat√°logo</h3>
                        <p class="section-description">Personaliza los colores principales de tu cat√°logo digital. Los cambios se reflejar√°n en la vista previa y se guardan en este navegador.</p>
                        <div class="appearance-grid" role="group" aria-label="Selector de colores del cat√°logo">
                            <div class="appearance-item">
                                <label for="appearanceBackground">Color de fondo</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="appearanceBackground" name="appearanceBackground" value="#f5f5f5">
                                    <span class="color-value" data-color-for="appearanceBackground">#f5f5f5</span>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceHeader">Color de encabezado y pie</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="appearanceHeader" name="appearanceHeader" value="#2d4a2b">
                                    <span class="color-value" data-color-for="appearanceHeader">#2d4a2b</span>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearancePrimary">Color de botones principales</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="appearancePrimary" name="appearancePrimary" value="#6b8e68">
                                    <span class="color-value" data-color-for="appearancePrimary">#6b8e68</span>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceAccent">Color de elementos destacados</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="appearanceAccent" name="appearanceAccent" value="#8fa68c">
                                    <span class="color-value" data-color-for="appearanceAccent">#8fa68c</span>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceText">Color de t√≠tulos y textos</label>
                                <div class="color-input-wrapper">
                                    <input type="color" id="appearanceText" name="appearanceText" value="#2d4a2b">
                                    <span class="color-value" data-color-for="appearanceText">#2d4a2b</span>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceBackgroundImage">Imagen de fondo del cat√°logo (opcional)</label>
                                <div class="input-meta">
                                    <input type="url" id="appearanceBackgroundImage" name="appearanceBackgroundImage" placeholder="https://ejemplo.com/fondo.jpg">
                                    <div class="field-hint field-hint--muted">Si lo dejas vac√≠o se mostrar√° el degradado configurado con los colores.</div>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceHeaderImage">Imagen del encabezado (opcional)</label>
                                <div class="input-meta">
                                    <input type="url" id="appearanceHeaderImage" name="appearanceHeaderImage" placeholder="https://ejemplo.com/encabezado.jpg">
                                    <div class="field-hint field-hint--muted">Se mezcla con los colores del encabezado para mantener la legibilidad.</div>
                                </div>
                            </div>
                            <div class="appearance-item">
                                <label for="appearanceFooterImage">Imagen del pie de p√°gina (opcional)</label>
                                <div class="input-meta">
                                    <input type="url" id="appearanceFooterImage" name="appearanceFooterImage" placeholder="https://ejemplo.com/footer.jpg">
                                    <div class="field-hint field-hint--muted">√ösalo para personalizar el fondo del cierre del cat√°logo.</div>
                                </div>
                            </div>
                        </div>
                        <button type="button" class="btn btn-secondary" id="resetAppearanceButton">Restaurar colores de f√°brica</button>
                    </div>

                    <button class="btn btn-primary" id="saveConfigButton">Guardar Configuraci√≥n</button>
                </div>

                <!-- Products Section -->
                <div id="productsSection" class="section" role="region" aria-labelledby="productsSectionTitle" aria-hidden="true" hidden>
                    <h2 class="section-title" id="productsSectionTitle">üì¶ Gesti√≥n de Productos</h2>

                    <div class="category-header">
                        <div class="category-tabs" id="categoryTabs"></div>
                        <div class="category-controls">
                            <button class="btn btn-secondary" type="button" id="manageCategoriesButton">‚öôÔ∏è Gestionar categor√≠as</button>
                            <button class="btn btn-primary" type="button" id="openProductModalButton">‚ûï A√±adir Producto</button>
                        </div>
                    </div>

                    <div class="product-search-bar">
                        <label class="sr-only" for="productSearch">Buscar productos</label>
                        <input type="text" id="productSearch" name="productSearch" placeholder="Buscar por nombre, descripci√≥n o etiquetas">
                        <p id="productSearchSummary" class="product-search-summary" aria-live="polite"></p>
                    </div>

                    <div id="productsList" class="product-list" style="margin-top: 1.5rem">
                        <!-- Products will be loaded here -->
                    </div>
                </div>

                <section id="previewSection" class="preview-section">
                    <h2 class="section-title">üëÄ Vista previa del cat√°logo</h2>
                    <iframe id="catalogPreview" title="Vista previa del cat√°logo"></iframe>
                </section>
            </div>
        </div>

        <!-- Export Section -->
        <div class="export-section">
            <h2 style="margin-bottom: 1rem">¬øListo para actualizar tu cat√°logo?</h2>
            <p style="margin-bottom: 1.5rem">Genera tu cat√°logo actualizado con todos los cambios realizados</p>
            <button class="big-button" data-action="generate-catalog">
                <span>üì•</span> Generar Cat√°logo Actualizado
            </button>
            <div id="statusMessage" class="status-message" style="margin-top: 1rem"></div>
            <div id="exportStatusPanel" class="process-panel" role="region" aria-live="polite" aria-label="Estado de generaci√≥n y exportaci√≥n">
                <div class="process-panel__header">
                    <span class="process-panel__title">Historial de generaci√≥n y exportaci√≥n</span>
                    <button type="button" class="process-panel__clear" id="clearProcessStatusButton">Limpiar historial</button>
                </div>
                <p class="process-panel__empty" id="exportStatusEmpty">A√∫n no has ejecutado exportaciones ni generado el cat√°logo.</p>
                <ul class="process-panel__list" id="exportStatusList" role="log"></ul>
            </div>
        </div>
    </div>

    <!-- Product Modal -->
    <div class="modal" id="productModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-hidden="true" tabindex="-1">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">A√±adir Producto</h2>
                <button class="close-modal" type="button" id="closeProductModalButton" aria-label="Cerrar formulario de producto">‚úï</button>
            </div>

            <form id="productForm">
                <input type="hidden" id="productId">
                
                <div class="form-group">
                    <label for="productCategory">Categor√≠a:</label>
                    <select id="productCategory"></select>
                </div>

                <div class="form-group">
                    <label for="productName">Nombre del producto:</label>
                    <input type="text" id="productName" required>
                </div>

                <div class="form-group">
                    <label for="productShortDesc">Descripci√≥n corta:</label>
                    <div class="input-meta">
                        <textarea id="productShortDesc" required aria-describedby="shortDescHint shortDescCounter"></textarea>
                        <div class="field-hint" id="shortDescHint">
                            Resume en una o dos frases el valor principal del producto.
                        </div>
                        <div class="char-counter" id="shortDescCounter" aria-live="polite">0 / 140 caracteres</div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="productLongDesc">Descripci√≥n detallada:</label>
                    <div class="input-meta">
                        <textarea id="productLongDesc" rows="4" aria-describedby="longDescHint longDescCounter"></textarea>
                        <div class="field-hint" id="longDescHint">
                            Utiliza vi√±etas o frases cortas para resaltar usos, materiales y cuidados.
                        </div>
                        <div class="char-counter" id="longDescCounter" aria-live="polite">0 / 400 caracteres</div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="productPrice">Precio:</label>
                    <div class="input-meta">
                        <input type="text" id="productPrice" placeholder="$45.000 o $85.000/m¬≤" aria-describedby="priceHint pricePreview">
                        <div class="field-hint" id="priceHint">
                            Ejemplos v√°lidos: $45.000, 125000 o 85.000/m¬≤.
                        </div>
                        <div class="field-hint field-hint--muted" id="pricePreview" aria-live="polite">Vista previa: ‚Äî</div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="productImageUrl">Im√°genes del producto:</label>
                    <div class="field-hint field-hint--muted">
                        Usa enlaces directos (por ejemplo, de <code>raw.githubusercontent.com</code>) y a√±ade todas las tomas que necesites.
                        El cat√°logo mostrar√° flechas para avanzar entre ellas.
                    </div>
                    <div id="productImagesList" class="image-url-list">
                        <div class="image-url-item">
                            <input type="url" class="product-image-url-input" id="productImageUrl" placeholder="https://raw.githubusercontent.com/...">
                            <button type="button" class="icon-btn remove-image-button" data-action="remove-image" aria-label="Eliminar imagen" title="Eliminar imagen">‚úï</button>
                        </div>
                    </div>
                    <button type="button" id="addProductImageButton" class="btn btn-secondary image-add-button">‚ûï A√±adir imagen</button>
                    <div class="image-preview" id="productImagePreviewWrapper">
                        <img id="productImagePreview" alt="Vista previa del producto" src="" />
                        <span class="image-placeholder" id="productImagePlaceholder">Sin imagen seleccionada</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Caracter√≠sticas (etiquetas):</label>
                    <div id="featuresList" class="feature-list"></div>
                    <button type="button" class="btn btn-secondary" id="addFeatureButton">+ A√±adir caracter√≠stica</button>
                </div>

                <div class="form-group">
                    <label for="productSpecs">Especificaciones t√©cnicas:</label>
                    <div class="warning-box">
                        Formato: Nombre: Valor (una por l√≠nea)<br>
                        Ejemplo:<br>
                        Material: Concreto reforzado<br>
                        Peso: 8 kg
                    </div>
                    <div class="input-meta">
                        <textarea id="productSpecs" rows="6" placeholder="Material: Concreto reforzado&#10;Dimensiones: 30cm x 25cm&#10;Peso: 8 kg" aria-describedby="specsHint specsCounter"></textarea>
                        <div class="field-hint" id="specsHint">
                            A√±ade cada especificaci√≥n en el formato <strong>Nombre: Valor</strong> para que se muestre correctamente.
                        </div>
                        <div class="char-counter" id="specsCounter" aria-live="polite">0 / 800 caracteres</div>
                    </div>
                </div>

                <div style="display: flex; gap: 1rem; justify-content: flex-end">
                    <button type="button" class="btn btn-secondary" id="cancelProductButton">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Guardar Producto</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Category Modal -->
    <div class="modal" id="categoryModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Gestionar Categor√≠as</h2>
                <button class="close-modal" type="button" id="closeCategoryModalButton">‚úï</button>
            </div>

            <div class="info-box">
                <strong>Organiza tus categor√≠as:</strong> Cambia los nombres, iconos o descripciones y elimina las categor√≠as que ya no necesites. Los cambios se reflejar√°n autom√°ticamente en la vista previa y en el cat√°logo exportado.
            </div>

            <div id="categoryManagerList" class="category-manager-list"></div>

            <div class="config-section">
                <h3 style="margin-bottom: 1rem">Crear nueva categor√≠a</h3>
                <div class="two-columns">
                    <div class="form-group">
                        <label for="newCategoryName">Nombre</label>
                        <input type="text" id="newCategoryName" placeholder="Ej: Luminarias">
                    </div>
                    <div class="form-group">
                        <label for="newCategoryIcon">Icono</label>
                        <input type="text" id="newCategoryIcon" placeholder="üí°">
                    </div>
                </div>
                <div class="form-group">
                    <label for="newCategoryDescription">Descripci√≥n</label>
                    <textarea id="newCategoryDescription" rows="3" placeholder="Describe brevemente la categor√≠a"></textarea>
                </div>
                <button type="button" class="btn btn-secondary" id="addCategoryButton">‚ûï A√±adir categor√≠a</button>
            </div>

            <div class="category-manager-actions">
                <button type="button" class="btn btn-secondary" id="cancelCategoryButton">Cerrar</button>
                <button type="button" class="btn btn-primary" id="saveCategoryChangesButton">Guardar cambios</button>
            </div>
        </div>
    </div>

    <!-- Import Data Modal -->
    <input type="file" id="importFile" style="display: none" accept=".json">

    <script src="admin.js" defer></script>
</body>
</html>
